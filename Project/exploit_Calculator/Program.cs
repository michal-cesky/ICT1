using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace exploit_Calculator
{
    internal class Program
    {
        //Int overflow first_Number or second_Number = 2300000000, operatorSymbol = +
        //String format first_Number or second_Number = 2,5, -3, operatorSymbol = +;
        //Stack overflow first_Number = 17000, operatorSymbol = !
        //Heap overflow first_Number = "1000000000", operatorSymbol = SUM

        private static string Path = "C:\\Users\\Oem\\Desktop\\Calculator-for-exploit\\bin\\Debug\\Calculator-for-exploit.exe";
        private static string first_Number = "10";
        private static string operator_Symbol = "SUM";
        private static string second_Number = "3";

        private static int exit_Code;
        private static string output;

        static void Main(string[] args)
        {
            ProcessStartInfo startInfo = new ProcessStartInfo();

            // Set the file name and arguments for the process
            startInfo.FileName = Path;
            startInfo.Arguments = $"{first_Number} {operator_Symbol} {second_Number}";

            startInfo.RedirectStandardOutput = true;
            startInfo.UseShellExecute = false;
            startInfo.RedirectStandardInput = true;

            // Start the process
            Process process = Process.Start(startInfo);

            // Read the output of the process
            output = process.StandardOutput.ReadToEnd();

            process.WaitForExit();
            exit_Code = process.ExitCode;

            // Display the output and exit code to the user
            Console.WriteLine("Output: " + output);
            Console.WriteLine("Exit Code: " + exit_Code);

            // Wait for user input before closing the console window
            Console.WriteLine("Press any key to exit...");
            Console.ReadLine();
        }
    }
}
